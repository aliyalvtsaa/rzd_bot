INFO:aiogram.dispatcher:Start polling
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-2' coro=<periodic_check() done, defined at /Users/aliya/rzd_telegram_bot/rzd_monitoring.py:32> exception=ServerSelectionTimeoutError('SSL handshake failed: ac-tervvam-shard-00-01.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-tervvam-shard-00-02.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-tervvam-shard-00-00.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6589786a17e250443eb0f9f1, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription (\'ac-tervvam-shard-00-00.ndrzlgu.mongodb.net\', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-00.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>, <ServerDescription (\'ac-tervvam-shard-00-01.ndrzlgu.mongodb.net\', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-01.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>, <ServerDescription (\'ac-tervvam-shard-00-02.ndrzlgu.mongodb.net\', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-02.ndrzlgu.mongodb.net:27017: [(\'SSL routines\', \'\', \'tlsv1 alert internal error\')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>]>')>
Traceback (most recent call last):
  File "/Users/aliya/rzd_telegram_bot/rzd_monitoring.py", line 34, in periodic_check
    user_records = mongo_connector.get_all_data()
  File "/Users/aliya/rzd_telegram_bot/mongodb_connector.py", line 20, in get_all_data
    return list(self.train_data_collection.find({}))
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/cursor.py", line 1264, in next
    if len(self.__data) or self._refresh():
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/cursor.py", line 1155, in _refresh
    self.__session = self.__collection.database.client._ensure_session()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/mongo_client.py", line 1823, in _ensure_session
    return self.__start_session(True, causal_consistency=False)
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/mongo_client.py", line 1766, in __start_session
    self._topology._check_implicit_session_support()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/topology.py", line 573, in _check_implicit_session_support
    self._check_session_support()
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/topology.py", line 589, in _check_session_support
    self._select_servers_loop(
  File "/Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pymongo/topology.py", line 259, in _select_servers_loop
    raise ServerSelectionTimeoutError(
pymongo.errors.ServerSelectionTimeoutError: SSL handshake failed: ac-tervvam-shard-00-01.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-tervvam-shard-00-02.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms),SSL handshake failed: ac-tervvam-shard-00-00.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6589786a17e250443eb0f9f1, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-tervvam-shard-00-00.ndrzlgu.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-00.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>, <ServerDescription ('ac-tervvam-shard-00-01.ndrzlgu.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-01.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>, <ServerDescription ('ac-tervvam-shard-00-02.ndrzlgu.mongodb.net', 27017) server_type: Unknown, rtt: None, error=AutoReconnect("SSL handshake failed: ac-tervvam-shard-00-02.ndrzlgu.mongodb.net:27017: [('SSL routines', '', 'tlsv1 alert internal error')] (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)")>]>
INFO:aiogram.dispatcher:Run polling for bot @RZD_Hunter_bot id=6743055173 - 'РЖД Билетный Сыщик'
INFO:aiogram.event:Update id=720225615 is handled. Duration 553 ms by bot id=6743055173
INFO:aiogram.event:Update id=720225616 is handled. Duration 2837 ms by bot id=6743055173
